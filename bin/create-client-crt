#!/bin/bash
set -e

USERNAME=$(whoami)
FULL_NAME=$(getent passwd $(whoami) | cut -d ':' -f 5 | cut -d ',' -f 1)
FQDN=$(hostname --fqdn)

openssl \
    req \
    -new \
    -nodes \
    -keyout ${FQDN}.key \
    -out ${FQDN}.csr \
     -subj "/C=US/ST=Internet/L=Internet/O=${FULL_NAME}/OU=${FQDN}/CN=${FQDN}/emailAddress=${USERNAME}@${FQDN}" \
    -days 365
